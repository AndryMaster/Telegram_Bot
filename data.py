######################################################################################################################
# –ü—Ä–æ–≥—Ä–∞–º–º–∞ "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π –¥–æ–º"
# –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è ItFest 2021
######################################################################################################################

import random

from enumes import Location, TypeLocation
from texts import TextFinal, TextNotGoodEnd, TextGoodEnd

######################################################################################################################
# Engine Data

# –û—Å–Ω–æ–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–π, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ª–æ–∫–∞—Ü–∏–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª–∏–Ω—É —Å–ø–∏—Å–∫–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
# {–∫–ª—é—á = [—Ç–∏–ø –ª–æ–∫–∞—Ü–∏–∏, —Ç–µ–∫—Å—Ç, –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å—Ö–æ–¥–∞, –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)]}
# –õ–æ–∫–∞—Ü–∏—è —Ç–∏–ø–∞ place - –ø—Ä–æ—Å—Ç–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Å—Ç–æ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã—Ö–æ–¥–æ–≤
# –õ–æ–∫–∞—Ü–∏—è —Ç–∏–ø–∞ quest - –∏–µ–º–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤—ã—Ö–æ–¥, –Ω–æ –≤—ã–π—Ç–∏ –º–æ–∂–Ω–æ —Ä–µ—à–∏–≤ —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á—É –∏–ª–∏ –æ—Å—Ç–∞—Ç—å—Å—è —Ç–∞–º —É–º–∏—Ä–∞—Ç—å —Å –≥–æ–ª–æ–¥—É
# –õ–æ–∫–∞—Ü–∏—è —Ç–∏–ø–∞ test - –∏–µ–º–µ—Ç 2 –≤—ã—Ö–æ–¥–∞, –Ω–æ –≤—ã—Ö–æ–¥ –≤—ã–±–∏—Ä–∞–µ—Ç –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∞ "–æ–¥–Ω–æ–∏–º–µ–Ω–Ω–∞—è" —Ñ—É–Ω–∫—Ü–∏—è (—Å–∫—Ä–∏–ø—Ç)
#                 –¥–ª—è —É–ø—Ä–æ—à—â–µ–Ω–∏—è —Ç–µ–ª–æ —Å–∫—Ä–∏–ø—Ç–∞ –≤—ã–Ω–µ—Å–µ–Ω–æ –∏–∑ GameData, —Ö–æ—Ç—è –º–æ–∂–Ω–æ –±—ã–ª–æ –µ–≥–æ –≤—ã–∑–≤–∞—Ç—å —á–µ—Ä–µ–∑ eval –ø–æ–ª–Ω–æ—Å—Ç—å—é

GameData = {
    Location.front_of_house: [
        TypeLocation.place,
        '''
    –í–æ—Ç –Ø –ø–µ—Ä–µ–¥ –¥–æ–º–æ–º.
    –î–æ–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ—á–µ–Ω—å —Å—Ç–∞—Ä—ã–π –∏ –Ω–µ –º–µ–Ω–µ–µ —Å—Ç—Ä–∞—à–Ω—ã–π.
    –î–∞–∞–∞, –∏ —Ç—É—Ç –º–Ω–µ –ø—Ä–∏–¥—ë—Ç—Å—è –Ω–æ—á–µ–≤–∞—Ç—å.
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–æ–π—Ç–∏ –≤ –¥–æ–º.
        2) –û–±–æ–π—Ç–∏ –¥–æ–º –ø–æ –∫—Ä—É–≥—É.''',
        [Location.first_floor_quest, Location.next_house]],

    Location.first_floor_quest: [
        TypeLocation.quest,
        '–ù–∞ –¥–≤–µ—Ä–∏ –∑–∞–º–æ–∫!',
        [Location.first_floor], ['–ù–∞–¥–æ –≤—Å–∫—Ä—ã—Ç—å –∑–∞–º–æ–∫:', '(2 + 3) * 5 - 2 = x', '23', 'x = ']],

    Location.next_house: [
        TypeLocation.place,
        '''
    –Ø –Ω–∞—Ö–æ–∂—É—Å—å –æ–∫–æ–ª–æ –¥–æ–º–∞, –ø–æ–¥ –æ–∫–Ω–æ–º –Ω–∞ –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–∂.
    %rnd%
    –¢—É—Ç –æ—á–µ–Ω—å —Å—ã—Ä–æ –∏ —Ö–æ–ª–æ–¥–Ω–æ ü•∂.
    –Ø –≤–∏–∂—É —á—Ç–æ –∫ –æ–∫–Ω—É –∏–¥—É—Ç –ª–∏–∞–Ω—ã!
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–ª–µ–∑—Ç—å –Ω–∞ –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–∂.
        2) –ü–æ–¥–æ–π—Ç–∏ –∫–æ –≤—Ö–æ–¥—É –≤ –¥–æ–º.''',
        [Location.first_room_quest, Location.front_of_house]],

    Location.first_room_quest: [
        TypeLocation.quest,
        '''
    –ö–≤–µ—Å—Ç: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ª–∏–∞–Ω—ã –∑–∞—Å–æ—Ö–ª–∏!
    –ù–∞–¥–æ –Ω–∞–π—Ç–∏ —Å–≤–µ–∂–∏–µ –ª–∏–∞–Ω—ã.''',
        [Location.first_room_test_inner], ['–ù–∞–π–¥–∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å!\n–í—Å—Ç–∞–≤—å –≤–º–µ—Å—Ç–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –æ—Ç–≤–µ—Ç:',
                                           '101100111000____0000', '1111', '____ = ']],

    Location.first_floor: [
        TypeLocation.place,
        '''
    –Ø –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–∂–µ —ç—Ç–æ–≥–æ –¥–æ–º–∞.
    –ù–∞–¥–æ —Ç—É—Ç –æ—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è, —É–±–µ–¥–∏—Ç—å—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ–º–∞, –∫–∞–∫ –Ω–æ—á–ª–µ–≥–∞. üò¥
    –õ–∏–≤–µ–Ω—å —Å–Ω–∞—Ä—É–∂–∏, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—Å—ë –Ω–∏–∫–∞–∫ –Ω–µ –ø—Ä–µ–∫—Ä–∞—â–∞–ª—Å—è.
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—å:
        1) –ü–æ–¥–Ω—è—Ç—å—Å—è –Ω–∞ –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–∂.
        2) –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –µ—Å—Ç—å –≤ –ø–æ–¥–≤–∞–ª–µ.
        3) –ó–∞–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É –ø–æ—Ö–æ–∂—É—é –Ω–∞ –∫—É—Ö–Ω—é.
        4) –í—ã–π—Ç–∏ –∏–∑ –¥–æ–º–∞.''',
        [Location.second_floor_1, Location.basement_test_inner, Location.kitchen_test_slingshot,
         Location.front_of_house]],

    Location.second_floor_1: [
        TypeLocation.place,
        '''
    –Ø –Ω–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–∂–µ —ç—Ç–æ–≥–æ —Å—Ç—Ä–∞–Ω–Ω–æ–≥–æ –¥–æ–º–∞.
    –ù–æ —Ç—É—Ç –±–æ–ª–µ–µ –ø—Ä–∏—è—Ç–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –Ω–æ—á–ª–µ–≥–∞.
    %rnd%
    –ù–∞–¥–æ –æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∂–¥—É—é –∫–æ–º–Ω–∞—Ç—É —ç—Ç–æ–≥–æ —ç—Ç–∞–∂–∞.
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –∫—É–¥–∞ –º–Ω–µ –ø–æ–π—Ç–∏:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤ 1-—É—é –∫–æ–º–Ω–∞—Ç—É.
        2) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤–æ 2-—É—é –∫–æ–º–Ω–∞—Ç—É.
        3) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤ 3-—É—é –∫–æ–º–Ω–∞—Ç—É –≤—Ä–æ–¥–µ "—Å–∞–º—É—é —É—é—Ç–Ω—É—é".
        4) –°–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–∂.''',
        [Location.first_room_test, Location.second_room, Location.final_room_test, Location.first_floor]],

    Location.second_floor_2: [
        TypeLocation.place,
        '''
    –í—Ç–æ—Ä–æ–π —ç—Ç–∞–∂ —ç—Ç–æ–≥–æ "–Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–≥–æ" –¥–æ–º–∞.
    %rnd%
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –∫—É–¥–∞ –º–Ω–µ –ø–æ–π—Ç–∏:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤ 1-—É—é –∫–æ–º–Ω–∞—Ç—É.
        2) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤–æ 2-—É—é –∫–æ–º–Ω–∞—Ç—É.
        3) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –≤ 3-—É—é –∫–æ–º–Ω–∞—Ç—É –≤—Ä–æ–¥–µ "—Å–∞–º—É—é —É—é—Ç–Ω—É—é".
        4) –°–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–∂.''',
        [Location.first_room_test, Location.second_room, Location.final_room_test, Location.first_floor]],

    Location.final_room_test: [
        TypeLocation.test,
        '   –ó–¥–µ—Å—å –∑–∞–º–æ–∫, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ 2 –∫–ª—é—á–∞!',
        [Location.final_room_quest, Location.second_floor_2]],

    Location.final_room_quest: [
        TypeLocation.quest,
        '\t–ö–≤–µ—Å—Ç: –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–ª—é—á–∏\n\t–ù–∞–¥–æ —Ç–æ–ª—å–∫–æ —É–∑–Ω–∞—Ç—å –∫–∞–∫?',
        [Location.final_room_test_inner], ['\t–î–ª—è —ç—Ç–æ–≥–æ —Ä–µ—à–∏ —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π:',
                                           '\t2k + x = 1\nk + y = 13\ny + x = 2\n2k = ...', '8', '2k = ']],

    Location.first_room_test: [
        TypeLocation.test,
        '   –≠—Ç–∞ –∫–æ–º–Ω–∞—Ç–∞ –∑–∞–ø–µ—Ä—Ç–∞ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã!',
        [Location.first_room_test_inner, Location.second_floor_2]],

    Location.first_room_test_inner: [
        TypeLocation.test,
        '',
        [Location.first_room_2, Location.first_room_quest_open]],

    Location.first_room_quest_open: [
        TypeLocation.quest,
        '''
    –≤ —ç—Ç–æ–π –∫–æ–º–Ω–∞—Ç–µ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑. –û–Ω–∞ –Ω–µ–æ–±—ã—á–Ω–∞—è –∏ –Ω–µ–º–Ω–æ–≥–æ –∂—É—Ç–∫–æ–≤–∞—Ç–∞—è!
    –í –±–æ–ª—å—à–æ–º —à–∫–∞—Ñ—É –Ø –Ω–∞—à—ë–ª –º–∏—Å—Ç–∏—á–µ—Å–∫—É—é "–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é" —à–∫–∞—Ç—É–ª–∫—É.
    –ö–≤–µ—Å—Ç: –•–æ—Ä–æ—à–æ, —á—Ç–æ –Ø –ª—é–±–ª—é –º–∞—Ç–µ–º–∞—Ç–∏–∫—É!''',
        [Location.first_room_1],
        ['–û—Ç–∫—Ä–æ–µ–º –µ—ë!', 'x = sin(30) * 4', '2', 'x = '],
        '–ó–¥–µ—Å—å –ª–µ–∂–∏—Ç –∫–ª—é—á!',
        True],

    Location.first_room_1: [
        TypeLocation.place,
        '''
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–ª–µ–∑—Ç—å –ø–æ –ª–∏–∞–Ω–µ —Å –æ–∫–Ω–∞ –Ω–∞ —É–ª–∏—Ü—É!
        2) –í—ã–π—Ç–∏ –≤ –∫–æ—Ä–∏–¥–æ—Ä –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–∂–∞.''',
        [Location.next_house, Location.second_floor_1]],

    Location.first_room_2: [
        TypeLocation.place,
        '''
    –í —ç—Ç–æ–π –∫–æ–º–Ω–∞—Ç–µ –Ø —É–∂–µ –≤—Å—ë –æ—Å–º–æ—Ç—Ä–µ–ª –∏ –æ—Ç–∫—Ä—ã–ª —à–∫–∞—Ç—É–ª–∫—É.
    –ó–∞—á–µ–º —è —Ö–æ–∂—É –∫—Ä—É–≥–∞–º–∏?
    %rnd%
    –ù–∞–¥–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ, –∞ —Ç–æ –Ø –∑–¥–µ—Å—å –±—É–¥—É –¥–æ —É—Ç—Ä–∞ –≤—Å—ë –ø—Ä–æ–≤–µ—Ä—è—Ç—å!
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å:
        1) –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–ª–µ–∑—Ç—å –ø–æ –ª–∏–∞–Ω–µ —Å –æ–∫–Ω–∞ –Ω–∞ —É–ª–∏—Ü—É!
        2) –í—ã–π—Ç–∏ –≤ –∫–æ—Ä–∏–¥–æ—Ä –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–∂–∞.''',
        [Location.next_house, Location.second_floor_1]],

    Location.second_room: [
        TypeLocation.place,
        '''
    –≠—Ç–∞ –∫–æ–º–Ω–∞—Ç–∞ –æ—Ç–∫—Ä—ã–ª–∞—Å—å –¥–æ–≤–æ–ª—å–Ω–æ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ.
    –ö–æ–º–Ω–∞—Ç–∞ –±—ã–ª–∞ –Ω–µ–±–æ–ª—å—à–∞—è, –Ω–æ –∑–¥–µ—Å—å –±—ã–ª–∞ –ª–µ—Å—Ç–Ω–∏—Ü–∞ –Ω–∞ —á–µ—Ä–¥–∞–∫.
    
    %rnd%
    
    –í –∫–æ–º–Ω–∞—Ç–µ –Ø –Ω–µ –Ω–∞—à—ë–ª –Ω–∏ –æ–¥–Ω–æ–π –≤–µ—â–∏, –∫–æ—Ç–æ—Ä–∞—è –º–Ω–µ –º–æ–≥–ª–∞ –±—ã –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è.
    –¢—É—Ç-–∂–µ –Ø –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –∫—Ä—ã–∂–∞ –ø—Ä–æ—Ç–µ–∫–∞–µ—Ç, —Ç–∞–∫ —Å–µ–±–µ –Ω–æ—á–ª–µ–≥!
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –∫—É–¥–∞ –∏–¥—Ç–∏:
        1) –ü–æ–¥–Ω—è—Ç—å—Å—è –Ω–∞ —á–µ—Ä–¥–∞–∫.
        2) –í–µ—Ä–Ω—É—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –∫–æ—Ä–∏–¥–æ—Ä.''',
        [Location.attic, Location.second_floor_1]],

    Location.attic: [
        TypeLocation.place,
        '''
    –ü–æ–∫–∞ –Ø –ª–µ–∑ –Ω–∞ –ø—ã–ª—å–Ω—ã–π —á–µ—Ä–¥–∞–∫, –Ω–∞–≥–ª–æ—Ç–∞–ª—Å—è –ø–∞—É—Ç–∏–Ω—ã üï∏!
    %rnd%
    –¢—É—Ç –±—ã–ª–æ –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ—Ä–Ω–æ.
    –ù–∞–¥–æ –∏–∑—É—á–∏—Ç—å –≤—Å—ë –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å:
        1) –°–ø—É—Å—Ç–∏—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ, —á–µ—Ä–µ–∑ –ø–∞—É–∫–æ–≤ üï∑.
        2) –í—ã–ª–µ–∑—Ç—å —á–µ—Ä–µ–∑ —â–µ–ª—å –≤ 1-—É—é –∫–æ–º–Ω–∞—Ç—É.
        3) –ó–∞–π—Ç–∏ –≤ –¥–∞–ª—å–Ω–∏–π –∫–æ–Ω–µ—Ü —á–µ—Ä–¥–∞–∫–∞.''',
        [Location.second_room, Location.first_room_test_inner, Location.attic_test_inner]],

    Location.attic_test_inner: [
        TypeLocation.test,
        '',
        [Location.attic_down]],

    Location.attic_down: [
        TypeLocation.place,
        '''
    –í —á–µ—Ä–¥–∞–∫–µ –æ–∫–∞–∑–∞–ª–∞—Å—å "–ø—Ä–æ–±–æ–∏–Ω–∞", –Ø –≥—Ä–æ–º–∫–æ —Å–≤–∞–ª–∏–ª—Å—è –Ω–∞ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–∂.
    –ö–æ–≥–¥–∞ –ø—Ä–∏—à—ë–ª –≤ —Å–æ–∑–Ω–∞–Ω–∏–µ, –≤—Å—ë —É–∂–∞—Å–Ω–æ –±–æ–ª–µ–ª–æ, –º–Ω–µ –±—ã–ª–æ —Å—Ç—Ä–∞—à–Ω–æ.
    –•–æ—Ä–æ—à–æ, —á—Ç–æ –Ø –≤—ã–∂–∏–ª –ø–æ—Å–ª–µ —Ç–∞–∫–æ–≥–æ. –í–µ–¥—å –º–æ–≥ –±—ã –∏ –Ω–µ –≤—ã–∂–∏—Ç—å!''',
        [Location.first_floor]],

    Location.basement_test_inner: [
        TypeLocation.test,
        '',
        [Location.basement_2, Location.basement_quest]],

    Location.basement_quest: [
        TypeLocation.quest,
        '''
    –í–æ—Ç —è —É–∂–µ –≤ —Ç—ë–º–Ω–æ–º –ø–æ–¥–≤–∞–ª–µ —ç—Ç–æ–≥–æ –¥–æ–º–∞.
    %rnd%
    –¢—É—Ç —É–∂ —Ç–æ—á–Ω–æ –º–µ—Å—Ç–æ –Ω–µ –¥–ª—è –Ω–æ—á–ª–µ–≥–∞.
    
    –°—Ç–æ–ø, —Ç—É—Ç –µ—Å—Ç—å –∫–∞–∫–∞—è-—Ç–æ —à–∫–∞—Ç—É–ª–∫–∞.''',
        [Location.basement_1],
        ['–≠—Ç–∞ —à–∫–∞—Ç—É–ª–∫–∞ —Ö–∏—Ç—Ä–æ –∑–∞–∫—Ä—ã—Ç–∞, –ø–æ–ø—Ä–æ–±—É—é –æ—Ç–∫—Ä—ã—Ç—å:', '2x + 3 = 3x - 4\nx = ...', '7', 'x = '],
        '\t–í —à–∫–∞—Ç—É–ª–∫–µ –±—ã–ª –∫–ª—é—á! –í–æ–∑—å–º—É –≤–¥—Ä—É–≥ –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è.',
        True],

    Location.basement_1: [
        TypeLocation.place,
        '''
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:
    1) –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —ç—Ç–æ—Ç –¥–æ–º.
    2) –í—ã–ª–µ–∑—Ç—å —á–µ—Ä–µ–∑ –º–∞–ª–µ–Ω—å–∫–æ–µ –æ–∫–Ω–æ –≤ –ø–æ–¥–≤–∞–ª–µ "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è".''',
        [Location.first_floor, Location.small_window_quest]],

    Location.basement_2: [
        TypeLocation.place,
        '''
    –í–æ—Ç —è —É–∂–µ –≤ —Ç—ë–º–Ω–æ–º –ø–æ–¥–≤–∞–ª–µ —ç—Ç–æ–≥–æ –¥–æ–º–∞.
    %rnd%
    –¢—É—Ç —É–∂ —Ç–æ—á–Ω–æ –º–µ—Å—Ç–æ –Ω–µ –¥–ª—è –Ω–æ—á–ª–µ–≥–∞.
        
    –≠—Ç—É —à–∫–∞—Ç—É–ª–∫—É —è —É–∂–µ –≤–∏–¥–µ–ª!
    –ó–∞—á–µ–º —è —Ö–æ–∂—É –∫—Ä—É–≥–∞–º–∏?
    
    –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–Ω–µ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:
        1) –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —ç—Ç–æ—Ç –¥–æ–º.
        2) –í—ã–ª–µ–∑—Ç—å —á–µ—Ä–µ–∑ –º–∞–ª–µ–Ω—å–∫–æ–µ –æ–∫–Ω–æ –≤ –ø–æ–¥–≤–∞–ª–µ "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è".''',
        [Location.first_floor, Location.small_window_quest]],

    Location.small_window_quest: [
        TypeLocation.quest,
        ''' 
    –ù—É —á—Ç–æ-–∂, –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ –ø—ã—Ç–∫–∞! –ù–∞–¥–µ—é—Å—å)''',
        [Location.next_house], ['–ù–∞–¥–æ –ø—Ä–æ–ª–µ–∑—Ç—å, –ø–æ–¥–±–µ—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:',
                                '–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ "n" –µ—Å–ª–∏ (n > 16) –∏ (n - —á—ë—Ç–Ω–æ–µ —á–∏—Å–ª–æ)', '16', 'n = '],
        '\t–ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ!'],  # 'min(n) if n > 14 and n % 2 == 0'

    Location.kitchen_test_slingshot: [
        TypeLocation.test,
        '',
        [Location.kitchen_1, Location.kitchen_2]],

    Location.kitchen_1: [
        TypeLocation.place,
        '''
    –ê –≤—Å–ø–æ–º–Ω–∏–ª, —è —Ç—É—Ç —É–∂–µ –±—ã–ª –∏ –≤–∑—è–ª —Ä–æ–≥–∞—Ç–∫—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –æ–±—Ä–∞—Ç–Ω–æ.
      ''',
        [Location.first_floor]],

    Location.kitchen_3: [
        TypeLocation.place,
        '''
    –û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ö–æ–ª –∏ –ø–æ–∏—Å–∫–∞—Ç—å –∫–ª—é—á.
      ''',
        [Location.first_floor]],

    Location.kitchen_4: [
        TypeLocation.place,
        '''
    –Ø—â–∏–∫ –æ—Ç–∫—Ä—ã–ª—Å—è, —è –±—ã–ª —Å–∏–ª—å–Ω–æ –Ω–∞–ø—É–≥–∞–Ω —É–≤–∏–¥–µ–≤ —á–µ—Ä–µ–ø –∫–∞–∫–æ–≥–æ-—Ç–æ –ª–µ—Å–Ω–æ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ-—Ö–∏—â–Ω–∏–∫–∞,
    –ï—â—ë —Ç—É—Ç –±—ã–ª–æ –º–Ω–æ–≥–æ —Ç–∞—Ä–∞–∫–∞–Ω–æ–≤ –∏ –ø–∞—Ö–ª–æ –Ω–µ –æ—á–µ–Ω—å. –ó–∞—Ç–æ —Ç—É—Ç –±—ã–ª–∞ —Ö–æ—Ä–æ—à–∞—è —Ä–æ–≥–∞—Ç–∫–∞.
    –û–Ω–∞ –±—ã–ª–∞ —Å—Ç–∞–ª—å–Ω–∞—è —Å –±—Ä–æ–Ω–∑–æ–≤—ã–º–∏ —à–∞—Ä–∏–∫–∞–º–∏-—Å–Ω–∞—Ä—è–¥–∞–º–∏, –ª–∞–¥–Ω–æ –≤–æ–∑—å–º—É —Å —Å–æ–±–æ–π.
    –¢—É—Ç –≥–¥–µ-—Ç–æ –≤ –¥–æ–º–µ —É–ø–∞–ª–∞ —Å—Ç–µ–∫–ª—è–Ω–Ω–∞—è –≤–∞–∑–∞. –ú–æ–∂–µ—Ç —ç—Ç–æ –∫—Ä—ã—Å—ã –±–µ–≥–∞—é—Ç –ø–æ —Å—Ç–æ–ª–∞–º?
    –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –∫–æ–º–Ω–∞—Ç—É, —Ç—É—Ç –±–æ–ª—å—à–µ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ.
      ''',
        [Location.first_floor]],

    Location.kitchen_2: [
        TypeLocation.place,
        '''
    –Ø –∑–∞—à—ë–ª –≤ –∫–æ–º–Ω–∞—Ç—É, –ø–æ—Ö–æ–∂—É—é –Ω–∞ –∫—É—Ö–Ω—é.
    –í—ã–≥–ª—è–¥–µ–ª–∞ –æ–Ω–∞ —É–∂–∞—Å–Ω–æ, –≤–µ–∑–¥–µ –ø–∞—Ö–ª–æ –≥–Ω–æ–µ–º.
    –í–æ –≤—Å–µ–π –∫–æ–º–Ω–∞—Ç–µ –Ω–µ –±—ã–ª–æ –Ω–∏—á–µ–≥–æ –¥–µ–ª—å–Ω–æ–≥–æ.
    –ö–æ–º–Ω–∞—Ç–∞ –±—ã–ª–∞ –ø—É—Å—Ç–∞, —Ö–æ—Ç—å —Ç—É—Ç –∏ –±—ã–ª–æ –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —à–∫–∞—Ñ–æ–≤!
    –û–¥–∏–Ω, –∫—Å—Ç–∞—Ç–∏, –∑–∞–∫—Ä—ã—Ç, –º–æ–∂–µ—Ç —Ö–æ—Ç—å –≤ –Ω—ë–º —á—Ç–æ-—Ç–æ –µ—Å—Ç—å!
    %rnd%
    
    –ü–æ—Ö–æ–∂–µ –ø—Ä–∏–¥—ë—Ç—Å—è –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –∏–ª–∏ ... :
        1) –í–µ—Ä–Ω—É—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ.
        2) –û—Å–º–æ—Ç—Ä–µ—Ç—å —à–∫–∞—Ñ.   ''',
        [Location.first_floor, Location.kitchen_test_key]],

    Location.kitchen_test_key: [
        TypeLocation.test,
        '''
    –£–ø—Å. –®–∫–∞—Ñ –∑–∞–∫—Ä—ã—Ç! –ú–Ω–µ –Ω—É–∂–µ–Ω –∫–ª—é—á –¥–ª—è —à–∫–∞—Ñ–∞.''',
        [Location.kitchen_quest, Location.kitchen_3]],

    Location.kitchen_quest: [
        TypeLocation.quest,
        '''
    –£ –º–µ–Ω—è –∫–∞–∫-—Ä–∞–∑ –µ—Å—Ç—å –æ—Ç–º—ã—á–∫–∞, –ø—Ä–∏–¥—ë—Ç—Å—è –ø–æ—Ç—Ä—É–¥–∏—Ç—å—Å—è!''',
        [Location.kitchen_4],
        ['–ù–∞–¥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞—à—É –æ—Ç–º—ã—á–∫—É!', '|(4 * 2 - 6) ** 3 - 3| * 111 = ...', '555', '–û—Ç–≤–µ—Ç: '],
        '',
        True],
    # ['–ù–∞–¥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–º—ã—á–∫—É –ø–æ–¥ —Ñ–æ—Ä–º—É –∑–∞–º–∫–∞:"_" - –ø—Ä–æ–ø—É—Å–∫, –∞ "|" - –ø–∞–ª–æ—á–∫–∞!',
    #     '–ó–∞–º–æ–∫:  ________________________\n            |  ||  ||  ||| | || ',  # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!!!
    #     '_||__||__||___|_|__|', '–ö–ª—é—á–∏–∫: ____', True],

    Location.final_room_test_inner: [
        TypeLocation.test,
        '',
        [Location.final_room_1, Location.final_room_2]],

    Location.final_room_1: [
        TypeLocation.place,
        TextFinal + '''
        3) –û–≥–ª—É—à–∏—Ç—å —É–¥–∞—Ä–æ–º —Å–Ω–∞—Ä—è–¥–∞ —Ä–æ–≥–∞—Ç–∫–∏,  –∏ –∫–∏–Ω—É—Ç—å—Å—è –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ –Ω–∞ —É–ª–∏—Ü—É! (–∞–∫—Ç–∏–≤–Ω–æ - –≤—ã –Ω–∞—à–ª–∏ —Ä–æ–≥–∞—Ç–∫—É)''',
        [Location.end_test_1, Location.end_2, Location.end_3]],

    Location.final_room_2: [
        TypeLocation.place,
        TextFinal + '''
        3) [–±–ª–æ–∫] –û–≥–ª—É—à–∏—Ç—å —É–¥–∞—Ä–æ–º —Å–Ω–∞—Ä—è–¥–∞ —Ä–æ–≥–∞—Ç–∫–∏,  –∏ –∫–∏–Ω—É—Ç—å—Å—è –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ –Ω–∞ —É–ª–∏—Ü—É! (–≤—ã –Ω–µ –Ω–∞—à–ª–∏ —Ä–æ–≥–∞—Ç–∫—É)''',
        [Location.end_test_1, Location.end_2]],

    Location.end_2: [
        TypeLocation.place,
        '''
    –Ø –±—Ä–æ—Å–∏–ª—Å—è, —á—Ç–æ –µ—Å—Ç—å –º–æ—á–∏ –∫ –≤—ã—Ö–æ–¥—É! –û–Ω–æ –Ω–µ –æ—Ç—Å—Ç–∞–≤–∞–ª–æ.
    –Ø –≤—ã—à–∏–± —Å—Ç–∞—Ä—É—é –¥–≤–µ—Ä—å –Ω–æ–≥–æ–π –∏ —Å–æ–±–∏—Ä–∞–ª—Å—è –±–µ–∂–∞—Ç—å –≤ –ª–µ—Å... ''' + TextNotGoodEnd,
        [Location.end]],

    Location.end_3: [
        TypeLocation.place,
        '''
    –Ø –Ω–µ –∑–Ω–∞—é –∫–∞–∫, –Ω–æ —è "—Å–ª—É—á–∞–π–Ω–æ" –ø–æ–ø–∞–ª –µ–º—É –≤ –≥—Ä—É–¥—å!
    –Ø –±—Ä–æ—Å–∏–ª—Å—è, —á—Ç–æ –µ—Å—Ç—å –º–æ—á–∏ –∫ –≤—ã—Ö–æ–¥—É! –ë—Ä–æ—Å–∏–≤ –Ω–µ—Å—á–∞—Å—Ç–Ω—É—é —Ä–æ–≥–∞—Ç–∫—É –Ω–∞ –ª–µ—Å—Ç–Ω–∏—Ü–µ.
    –Ø –≤—ã—à–∏–± —Å—Ç–∞—Ä—É—é –¥–≤–µ—Ä—å –Ω–æ–≥–æ–π –∏ —Å–æ–±–∏—Ä–∞–ª—Å—è –±–µ–∂–∞—Ç—å –¥–∞–ª–µ–∫–æ-–¥–∞–ª–µ–∫–æ –≤ –ª–µ—Å...''' + TextGoodEnd,
        [Location.end]],

    Location.end_test_1: [
        TypeLocation.test,
        '',
        [Location.end_1_a, Location.end_1_b]],

    Location.end_1_a: [
        TypeLocation.place,
        '''
    –Ø –≤ —Å—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–µ–∫—É–Ω–¥—ã –≤—ã–ø—Ä—ã–≥–Ω—É–ª –≤ –æ–∫–Ω–æ, –¥—É–º–∞—è, —á—Ç–æ —ç—Ç–æ –Ω–µ —Ö—É–¥—à–µ–µ, —á—Ç–æ –º–æ–≥–ª–æ —Å–ª—É—á–∏—Ç—å—Å—è!
    –í —ç—Ç–∏ —Å–µ–∫—É–Ω–¥—ã –º–æ—ë —Å–µ—Ä–¥—Ü–µ —á—É—Ç—å –Ω–µ –ª–æ–ø–Ω—É–ª–æ –æ—Ç —Å—Ç—Ä–∞—Ö–∞...
    –ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è –ø–æ–≤–µ–∑–ª–æ, —á—Ç–æ –ø–æ–¥ –æ–∫–æ–º –±—ã–ª–∏ –∫—É—Å—Ç—ã, —Å–º—è–≥—á–∏–≤—à–∏–µ –ø–∞–¥–µ–Ω–∏–µ!
    %pause%
    –ú–Ω–µ –ø—Ä–∞–≤–¥–∞ –ø–æ–≤–µ–∑–ª–æ! –Ø –ø–æ—Ä–∞–Ω–∏–ª—Å—è –æ –≤–µ—Ç–∫–∏, –Ω–æ –º–æ–≥ –±–µ–∂–∞—Ç—å...''' + TextGoodEnd,
        [Location.end]],

    Location.end_1_b: [
        TypeLocation.place,
        '''
    –Ø –≤ —Å—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–µ–∫—É–Ω–¥—ã –≤—ã–ø—Ä—ã–≥–Ω—É–ª –≤ –æ–∫–Ω–æ, –¥—É–º–∞—è, —á—Ç–æ —ç—Ç–æ –Ω–µ —Ö—É–¥—à–µ–µ, —á—Ç–æ –º–æ–≥–ª–æ —Å–ª—É—á–∏—Ç—å—Å—è!
    –í —ç—Ç–∏ —Å–µ–∫—É–Ω–¥—ã –º–æ—ë —Å–µ—Ä–¥—Ü–µ —á—É—Ç—å –Ω–µ –ª–æ–ø–Ω—É–ª–æ –æ—Ç —Å—Ç—Ä–∞—Ö–∞...
    –ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è –ø–æ–≤–µ–∑–ª–æ, —á—Ç–æ –ø–æ–¥ –æ–∫–æ–º –±—ã–ª–∏ –∫—É—Å—Ç—ã, —Å–º—è–≥—á–∏–≤—à–∏–µ –ø–∞–¥–µ–Ω–∏–µ!
    %pause%
    –°–ª—É—á–∏–ª–æ—Å—å —Ö—É–¥—à–µ–µ, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, –Ø —É–ø–∞–ª –∏ —Å–ª–æ–º–∞–ª –Ω–æ–≥—É, –Ø –æ–±—Ä–µ—á—ë–Ω.
    –û–Ω–æ —É–∂–µ –±—ã–ª–æ —É –≤—ã—Ö–æ–¥–∞!''' + TextNotGoodEnd,
        [Location.end]]
}


#############################################################################################################
# –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –ª–æ–∫–∞—Ü–∏—è—Ö


async def first_room_test(user):
    return user.once_first_room


async def final_room_test(user):
    if user.keys == 0:
        await user.send("\t–£ –≤–∞—Å –Ω–µ—Ç –∫–ª—é—á–µ–π, –ø–æ–∏—â–∏—Ç–µ –≤ –¥–æ–º–µ.")
    if user.keys == 1:
        await user.send("\t–£ –≤–∞—Å 1 –∫–ª—é—á, –ø–æ–∏—â–∏—Ç–µ –≤—Ç–æ—Ä–æ–π –≤ –¥–æ–º–µ.")
    return user.keys == 2


async def first_room_test_inner(user):
    if not user.once_first_room:
        user.once_first_room = True
        user.keys += 1
        # await user.my_loot()
        return False
    else:
        return True


async def attic_test_inner(user):
    if not user.master_key:
        user.master_key = True
        await user.send('\t–¢–∞–∫, —è —Ç—É—Ç –Ω–∞—à—ë–ª "–æ—Ç–º—ã—á–∫—É", –æ–Ω–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è!')
        await user.send('\t–ú–æ–∂–µ—Ç —Ç—É—Ç –µ—Å—Ç—å –µ—â—ë "—Å–æ–∫—Ä–æ–≤–∏—â–∞"?')
        await user.my_loot()
    return True


async def basement_test_inner(user):
    if not user.once_basement:
        user.once_basement = True
        user.keys += 1
        # await user.my_loot()
        return False
    else:
        return True


async def kitchen_test_slingshot(user):
    return user.slingshot


async def kitchen_test_key(user):
    if user.master_key:
        user.slingshot = True
        # await user.my_loot()
        return True
    else:
        return False


async def final_room_test_inner(user):
    return user.slingshot


async def end_test_1(user):
    return bool(random.randrange(0, 3))


async def run_eval(fn, user):
    return await eval(fn + "(user)", globals(), locals())
